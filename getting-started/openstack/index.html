<!DOCTYPE html>
  
  
  
  
   <html class="no-js"> 

  <head lang="en-us">
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width,user-scalable=no,initial-scale=1,maximum-scale=1">
    <title>How to deploy Skydive with Devstack - Skydive Docs</title>
    <meta name="generator" content="Hugo 0.15" />

    
    <meta name="description" content="Real-time network analyzer.">
    
    <link rel="canonical" href="//skydive-project.github.io/skydive/getting-started/openstack/">
    
    <meta name="author" content="skydive-project/skydive">
    

    <meta property="og:url" content="//skydive-project.github.io/skydive/getting-started/openstack/">
    <meta property="og:title" content="Skydive Docs">
    <meta property="og:image" content="//skydive-project.github.io/skydive/images/skydive-logo.png">
    <meta name="apple-mobile-web-app-title" content="Skydive Docs">
    <meta name="apple-mobile-web-app-capable" content="yes">
    <meta name="apple-mobile-web-app-status-bar-style" content="black-translucent">

    <link rel="shortcut icon" type="image/x-icon" href="//skydive-project.github.io/skydive/images/skydive-logo-16x16.png">
    <link rel="icon" type="image/x-icon" href="//skydive-project.github.io/skydive/images/skydive-logo-16x16.png">

    <style>
      @font-face {
        font-family: 'Icon';
        src: url('//skydive-project.github.io/skydive/fonts/icon.eot?52m981');
        src: url('//skydive-project.github.io/skydive/fonts/icon.eot?#iefix52m981')
               format('embedded-opentype'),
             url('//skydive-project.github.io/skydive/fonts/icon.woff?52m981')
               format('woff'),
             url('//skydive-project.github.io/skydive/fonts/icon.ttf?52m981')
               format('truetype'),
             url('//skydive-project.github.io/skydive/fonts/icon.svg?52m981#icon')
               format('svg');
        font-weight: normal;
        font-style: normal;
      }
    </style>

    <link rel="stylesheet" href="//skydive-project.github.io/skydive/stylesheets/application.css">
    <link rel="stylesheet" href="//skydive-project.github.io/skydive/stylesheets/palettes.css">
    <link rel="stylesheet" href="//skydive-project.github.io/skydive/stylesheets/highlight/highlight.css">

    
    
    
    <link rel="stylesheet" href="//fonts.googleapis.com/css?family=Ubuntu:400,700|Ubuntu%2bMono">
    <style>
      body, input {
        font-family: 'Ubuntu', Helvetica, Arial, sans-serif;
      }
      pre, code {
        font-family: 'Ubuntu Mono', 'Courier New', 'Courier', monospace;
      }
    </style>
    
    
    <script src="//skydive-project.github.io/skydive/javascripts/modernizr.js"></script>

    

  </head>
  <body class="palette-primary-light-blue palette-accent-white">



	
	


<div class="backdrop">
	<div class="backdrop-paper"></div>
</div>

<input class="toggle" type="checkbox" id="toggle-drawer">
<input class="toggle" type="checkbox" id="toggle-search">
<label class="toggle-button overlay" for="toggle-drawer"></label>

<header class="header">
	<nav aria-label="Header">
  <div class="bar default">
    <div class="button button-menu" role="button" aria-label="Menu">
      <label class="toggle-button icon icon-menu" for="toggle-drawer">
        <span></span>
      </label>
    </div>
    <div class="stretch">
      <div class="title">
        How to deploy Skydive with Devstack
      </div>
    </div>

    

    
    <div class="button button-github" role="button" aria-label="GitHub">
      <a href="https://github.com/skydive-project/skydive" title="@skydive-project/skydive on GitHub" target="_blank" class="toggle-button icon icon-github"></a>
    </div>
    
    
        
  </div>
  <div class="bar search">
    <div class="button button-close" role="button" aria-label="Close">
      <label class="toggle-button icon icon-back" for="toggle-search"></label>
    </div>
    <div class="stretch">
      <div class="field">
        <input class="query" type="text" placeholder="Search" autocapitalize="off" autocorrect="off" autocomplete="off" spellcheck>
      </div>
    </div>
    <div class="button button-reset" role="button" aria-label="Search">
      <button class="toggle-button icon icon-close" id="reset-search"></button>
    </div>
  </div>
</nav>
</header>

<main class="main">
	<div class="drawer">
		<nav aria-label="Navigation">
  <a href="https://github.com/skydive-project/skydive" class="project">
    <div class="banner">
      
        <div class="logo">
          <img src="//skydive-project.github.io/skydive/images/skydive-logo.png">
        </div>
      
      <div class="name">
        <strong>Skydive Docs <span class="version">0.8.0</span></strong>
        
          <br>
          skydive-project/skydive
        
      </div>
    </div>
  </a>

  <div class="scrollable">
    <div class="wrapper">
      
        <ul class="repo">
          <li class="repo-download">
            <a href="https://github.com/skydive-project/skydive/archive/master.zip" target="_blank" title="Download" data-action="download">
              <i class="icon icon-download"></i> Download
            </a>
          </li>
          <li class="repo-stars">
            <a href="https://github.com/skydive-project/skydive/stargazers" target="_blank" title="Stargazers" data-action="star">
              <i class="icon icon-star"></i> Stars
              <span class="count">&ndash;</span>
            </a>
          </li>
        </ul>
        <hr>
      

      <div class="toc">
        
        <ul>
          




<li>
  
    



<a  title="Home" href="//skydive-project.github.io/skydive/">
	
	Home
</a>

  
  
</li>



<li>
  
  <li>
    

    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
      <span class="section">Getting-Started</span>
      
    
      
    
      
    
      
    
      
    
    

    <ul>
      
        
        



<a  title="Installation" href="//skydive-project.github.io/skydive/getting-started/install/">
	
	Installation
</a>

  
      
        
        



<a  title="Client &amp; WebUI" href="//skydive-project.github.io/skydive/getting-started/client/">
	
	Client &amp; WebUI
</a>

  
      
        
        



<a  title="Docker" href="//skydive-project.github.io/skydive/getting-started/docker/">
	
	Docker
</a>

  
      
        
        



<a class="current" title="Openstack" href="//skydive-project.github.io/skydive/getting-started/openstack/">
	
	Openstack
</a>


<ul id="scrollspy">
</ul>
  
      
        
        



<a  title="Vagrant" href="//skydive-project.github.io/skydive/getting-started/vagrant/">
	
	Vagrant
</a>

  
      
        
        



<a  title="Kubernetes" href="//skydive-project.github.io/skydive/getting-started/kubernetes/">
	
	Kubernetes
</a>

  
      
    </ul>
  </li>
  
</li>



<li>
  
  <li>
    

    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
      <span class="section">Api</span>
      
    
      
    
      
    
      
    
      
    
      
    
    

    <ul>
      
        
        



<a  title="Gremlin language" href="//skydive-project.github.io/skydive/api/gremlin/">
	
	Gremlin language
</a>

  
      
        
        



<a  title="Flows" href="//skydive-project.github.io/skydive/api/flows/">
	
	Flows
</a>

  
      
        
        



<a  title="Rest" href="//skydive-project.github.io/skydive/api/rest/">
	
	Rest
</a>

  
      
    </ul>
  </li>
  
</li>



<li>
  
    



<a  title="Deployment" href="//skydive-project.github.io/skydive/deployment/">
	
	Deployment
</a>

  
  
</li>



<li>
  
    



<a  title="Architecture" href="//skydive-project.github.io/skydive/architecture/">
	
	Architecture
</a>

  
  
</li>



<li>
  
    



<a  title="Contributing" href="//skydive-project.github.io/skydive/contributing/">
	
	Contributing
</a>

  
  
</li>



<li>
  
  <li>
    

    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
      <span class="section">Use-Cases</span>
      
    
      
    
    

    <ul>
      
        
        



<a  title="Packet Injector" href="//skydive-project.github.io/skydive/use-cases/packet-injector/">
	
	Packet Injector
</a>

  
      
    </ul>
  </li>
  
</li>



<li>
  
    



<a  title="Contact" href="//skydive-project.github.io/skydive/contact/">
	
	Contact
</a>

  
  
</li>



<li>
  
    



<a  title="License" href="//skydive-project.github.io/skydive/license">
	
	License
</a>

  
  
</li>

        </ul>
        

        
        <hr>
        <span class="section">The author</span>
        
        <ul>
          

          
          <li>
            <a href="https://github.com/skydive-project/skydive" target="_blank" title="@skydive-project/skydive on GitHub">
              @skydive-project/skydive on GitHub
            </a>
          </li>
          
        </ul>
        
      </div>
    </div>
  </div>
</nav>

	</div>

	<article class="article">
		<div class="wrapper">
			<h1>How to deploy Skydive with Devstack </h1>

			

<h2 id="devstack-plugin">Devstack plugin</h2>

<p>Skydive provides a DevStack plugin that can be used in order to have
Skydive Agents/Analyzer set up with the proper probes
by DevStack.</p>

<p>For a single node setup adding the following lines to your local.conf file
should be enough.</p>

<pre><code class="language-console">enable_plugin skydive https://github.com/skydive-project/skydive.git

enable_service skydive-agent skydive-analyzer
</code></pre>

<p>The plugin accepts the following parameters:</p>

<pre><code class="language-console"># Address on which skydive analyzer process listens for connections.
# Must be in ip:port format
#SKYDIVE_ANALYZER_LISTEN=

# Inform the agent about the address on which analyzers are listening
# Must be in ip:port format
#SKYDIVE_AGENT_ANALYZERS=

# ip:port address on which skydive agent listens for connections.
#SKYDIVE_AGENT_LISTEN=

# Configure the skydive agent with the etcd server address
# http://IP_ADDRESS:2379
#SKYDIVE_AGENT_ETCD=

# The path for the generated skydive configuration file
#SKYDIVE_CONFIG_FILE=

# List of agent probes to be used by the agent
# Ex: netns netlink ovsdb
#SKYDIVE_AGENT_PROBES=

# Remote port for ovsdb server.
#SKYDIVE_OVSDB_REMOTE_PORT=6640

# Set the default log level, default: INFO
#SKYDIVE_LOGLEVEL=DEBUG

# List of public interfaces for the agents to register in fabric
#SKYDIVE_PUBLIC_INTERFACES=devstack1/eth0 devstack2/eth1
</code></pre>

<h2 id="the-classical-two-nodes-deployment">The classical two nodes deployment</h2>

<p>Inside the Devstack folder of the Skydive sources there are two local.conf files
that can be used in order to deployment two Devstack with Skydive. The first
file will install a full Devstack with Skydive analyzer and agent. The second
one will install a compute Devstack with only the skydive agent.</p>

<p>For Skydive to create a TOR object that links both Devstack, add the following
line to your local.conf file:</p>

<pre><code class="language-console">SKYDIVE_PUBLIC_INTERFACES=devstack1/eth0 devstack2/eth1
</code></pre>

<p>where <code>devstack1</code> and <code>devstack2</code> are the hostnames of the two nodes followed
by their respective public interface.</p>

<p>Skydive will be set with the probes for OpenvSwitch and Neutron. It will be set
to use Keystone as authentication mechanism, so the credentials will be the same
than the admin.</p>

<p>Once you have your environment set up, going to the Analyzer Web Interface
should show similar to the following capture.</p>

<p><img src="//skydive-project.github.io/skydive/images/devstack-two-nodes.png" alt="WebUI Capture" /></p>

<h2 id="capture-traffic">Capture traffic</h2>

<p>Now we have our two nodes up and running we may want to start capturing
packets. The following command can be used in order to start a capture on all
the <code>br-int</code> bridges.</p>

<pre><code class="language-console">$ export SKYDIVE_USERNAME=admin
$ export SKYDIVE_PASSWORD=password
$ export SKYDIVE_AGENT_ANALYZERS=localhost:8082 # Should be the same as SERVICE_HOST in local.conf

$ skydive client capture create --gremlin &quot;G.V().Has('Name', 'br-int')&quot;
</code></pre>

<pre><code class="language-console">$ skydive client capture list
{
  &quot;d62b3176-ebc8-44ed-7001-191270dc4d76&quot;: {
    &quot;UUID&quot;: &quot;d62b3176-ebc8-44ed-7001-191270dc4d76&quot;,
    &quot;GremlinQuery&quot;: &quot;G.V().Has('Name', 'br-int')&quot;,
    &quot;Count&quot;: 1
  }
}
</code></pre>

<p>To get Flows captured :</p>

<pre><code class="language-console">skydive client topology query --gremlin &quot;G.Flows()&quot;
[
  {
    &quot;ANodeUUID&quot;: &quot;422190f1-bbde-4eb0-4849-1fd1209229fe&quot;,
    &quot;BNodeUUID&quot;: &quot;f3f1256b-7097-487c-7a02-38a32e009b3c&quot;,
    &quot;LastUpdateMetric&quot;: {
      &quot;ABBytes&quot;: 490,
      &quot;ABPackets&quot;: 5,
      &quot;BABytes&quot;: 490,
      &quot;BAPackets&quot;: 5,
      &quot;Last&quot;: 1477567166,
      &quot;Start&quot;: 1477567161
    },
    &quot;LayersPath&quot;: &quot;Ethernet/IPv4/ICMPv4/Payload&quot;,
    &quot;Link&quot;: {
      &quot;A&quot;: &quot;02:48:4f:c4:40:99&quot;,
      &quot;B&quot;: &quot;e2:d0:f0:61:e7:81&quot;,
      &quot;Protocol&quot;: &quot;ETHERNET&quot;
    },
    &quot;Metric&quot;: {
      &quot;ABBytes&quot;: 364560,
      &quot;ABPackets&quot;: 3720,
      &quot;BABytes&quot;: 364560,
      &quot;BAPackets&quot;: 3720,
      &quot;Last&quot;: 1477567165,
      &quot;Start&quot;: 1477563444
    },
    &quot;Network&quot;: {
      &quot;A&quot;: &quot;192.168.0.1&quot;,
      &quot;B&quot;: &quot;192.168.0.2&quot;,
      &quot;Protocol&quot;: &quot;IPV4&quot;
    },
    &quot;NodeUUID&quot;: &quot;f3f1256b-7097-487c-7a02-38a32e009b3c&quot;,
    &quot;TrackingID&quot;: &quot;f745fb1f59298a1773e35827adfa42dab4f469f9&quot;,
    &quot;UUID&quot;: &quot;caa24da240cb3b40c84ebb708e2e5dcbe3c54784&quot;
  }
]
</code></pre>

<p>For a complete description of the flow structure can be found
<a href="//skydive-project.github.io/skydive/api/flows/">here</a>.</p>

			
			<aside class="copyright" role="note">
				
				&copy; 2016 Released under the Apache license 2.0 &ndash;
				
				Documentation built with
				<a href="https://www.gohugo.io" target="_blank">Hugo</a>
				using the
				<a href="http://github.com/digitalcraftsman/hugo-material-docs" target="_blank">
					Material
				</a> theme.
			</aside>

			<footer class="footer">
				

<nav class="pagination" aria-label="Footer">
  <div class="previous">
  
      <a href="//skydive-project.github.io/skydive/getting-started/docker/" title="How to deploy Skydive with Docker">
        <span class="direction">
          Previous
        </span>
        <div class="page">
          <div class="button button-previous" role="button" aria-label="Previous">
            <i class="icon icon-back"></i>
          </div>
          <div class="stretch">
            <div class="title">
              How to deploy Skydive with Docker
            </div>
          </div>
        </div>
      </a>
  
  </div>

  <div class="next">
  
      <a href="//skydive-project.github.io/skydive/contributing/" title="Contributing">
        <span class="direction">
          Next
        </span>
        <div class="page">
          <div class="stretch">
            <div class="title">
              Contributing
            </div>
          </div>
          <div class="button button-next" role="button" aria-label="Next">
            <i class="icon icon-forward"></i>
          </div>
        </div>
      </a>
  
  </div>
</nav>




			</footer>
		</div>
	</article>

	<div class="results" role="status" aria-live="polite">
		<div class="scrollable">
			<div class="wrapper">
				<div class="meta"></div>
				<div class="list"></div>
			</div>
		</div>
	</div>
</main>

    <script>
    
      var base_url = '\/\/skydive-project.github.io\/skydive\/';
      var repo_id  = 'skydive-project\/skydive';
    
    </script>

    <script src="//skydive-project.github.io/skydive/javascripts/application.js"></script>
    

    <script>
      /* Add headers to scrollspy */
      var headers   = document.getElementsByTagName("h2");
      var scrollspy = document.getElementById('scrollspy');

      if(headers.length > 0) {
        for(var i = 0; i < headers.length; i++) {
          var li = document.createElement("li");
          li.setAttribute("class", "anchor");

          var a  = document.createElement("a");
          a.setAttribute("href", "#" + headers[i].id);
          a.setAttribute("title", headers[i].innerHTML);
          a.innerHTML = headers[i].innerHTML;
          
          li.appendChild(a)
          scrollspy.appendChild(li);
        }
      } else {
        scrollspy.parentElement.removeChild(scrollspy)
      }
      

      /* Add permanent link next to the headers */
      var headers = document.querySelectorAll("h1, h2, h3, h4, h5, h6");

      for(var i = 0; i < headers.length; i++) {
          var a = document.createElement("a");
          a.setAttribute("class", "headerlink");
          a.setAttribute("href", "#" + headers[i].id);
          a.setAttribute("title", "Permanent link")
          a.innerHTML = "#";
          headers[i].appendChild(a);
      }
    </script>

    

    <script src="//gohugo.io/js/highlight.pack.js"></script>
    <script>hljs.initHighlightingOnLoad();</script>
  </body>
</html>